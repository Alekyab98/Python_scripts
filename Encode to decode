import csv
import subprocess
import json
from datetime import datetime, timezone
import base64

# Function to decode the curl command
def decode_curl_command(encoded_command):
    return base64.b64decode(encoded_command).decode('utf-8')

# Function to convert epoch time to a readable timestamp
def convert_epoch_to_timestamp(value):
    return datetime.fromtimestamp(int(value), tz=timezone.utc).strftime('%Y-%m-%d %H:%M:%S')

# Execute the curl command
def execute_curl_and_get_data(curl_command):
    # Decode the curl command
    decoded_command = decode_curl_command(curl_command)

    # Execute the decoded curl command
    result = subprocess.run(decoded_command, shell=True, capture_output=True, text=True)

    if result.returncode != 0:
        print(f"Error executing curl command: {result.stderr}")
        return None  # Return None if curl failed

    return result.stdout
